<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>/* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ | ~# cr1s1um > /dev/random</title><meta name=keywords content="Programming languages,Python"><meta name=description content="Discover bannator.py: a 44 line Python script that blocks brute force attacks on Linux. A practical example of security and coding."><meta name=author content="Vincenzo Argese"><link rel=canonical href=https://cr1s1um.github.io/en/post/bannator-python-script-blocks-brute-force/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://cr1s1um.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cr1s1um.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cr1s1um.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cr1s1um.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cr1s1um.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://cr1s1um.github.io/en/post/bannator-python-script-blocks-brute-force/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XHH0DSS4T3"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XHH0DSS4T3")}</script><meta property="og:url" content="https://cr1s1um.github.io/en/post/bannator-python-script-blocks-brute-force/"><meta property="og:site_name" content="~# cr1s1um > /dev/random"><meta property="og:title" content="/* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */"><meta property="og:description" content="Discover bannator.py: a 44 line Python script that blocks brute force attacks on Linux. A practical example of security and coding."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-08-13T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-13T00:00:00+00:00"><meta property="article:tag" content="Programming Languages"><meta property="article:tag" content="Python"><meta name=twitter:card content="summary"><meta name=twitter:title content="/* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */"><meta name=twitter:description content="Discover bannator.py: a 44 line Python script that blocks brute force attacks on Linux. A practical example of security and coding."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cr1s1um.github.io/en/post/"},{"@type":"ListItem","position":2,"name":"/* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */","item":"https://cr1s1um.github.io/en/post/bannator-python-script-blocks-brute-force/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"/* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */","name":"\/* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) *\/","description":"Discover bannator.py: a 44 line Python script that blocks brute force attacks on Linux. A practical example of security and coding.","keywords":["Programming languages","Python"],"articleBody":"Introduction Some projects are born out of technical necessity, others from curiosity and the desire to experiment.\nBannator.py was created for all these reasons.\nIt was April 2, 2010. I was working as a consultant for a company that was experiencing repeated unauthorized access attempts on its servers: classic SSH password brute force attacks. A quick, simple, and understandable solution was needed. I could have written a couple of lines in Bash and solved the problem in a few minutes… but this was also an opportunity: to turn a technical need into a learning moment.\nThe company’s technical team had shown interest in Python, considering it more “readable” and “user-friendly” compared to Bash scripts and other sysadmin-oriented solutions. So, I decided to create a small script of just 44 lines, commented line by line, so it would not only be a tool but also a practical example of system automation in Python.\nThe result was Bannator.py – named because it’s the terminator of annoying IPs.\nA script that:\nReads the authentication logs (/var/log/auth.log) Identifies IPs with multiple failed login attempts Counts failed attempts Automatically blocks persistent IPs by writing them into /etc/hosts.deny Creates a backup of the block file, so no rules are lost I also created a YouTube video tutorial showing the script in action on a VirtualBox machine running Debian (version 5.0 Lenny). It was a way to combine teaching and real-world practice, demonstrating how a security issue can be solved with a simple “homegrown” but effective approach.\nWhy bring it back today? Today is August 14, 2025. More than 15 years after its first publication, Bannator.py is obviously outdated (…it already was) compared to modern integrated security solutions, but it still remains:\nA perfect example for anyone who wants to learn how to read and write Python scripts A practical exercise in log parsing A small piece of personal history Useful links GitHub Project YouTube Video Tutorial Full Code Original code dated April 2, 2010 Republished on an old website on February 23, 2023 #!/usr/bin/env python # -*- coding: utf-8 -*- # # Autore: Vincenzo Argese @crisiumdevstudio # YouTube: https://www.youtube.com/@crisiumdevstudio \u003c-- Iscriviti e attiva la campanella GRAZIE # # Script: bannator.py # Descrizione: Script Python – bloccare IP da attacchi brute force # Data pubblicazione: 2 Aprile 2010 (Data di oggi 23 feb 2023 ...OMG) # # Web: www.vasystems.it # Articolo: https://www.informaticawebsystems.com/guida-script-python-bloccare-indirizzi-ip-attacchi-brute-force/ # (Ex-Progetto) Progetto Elven.it WebTV: https://www.youtube.com/channel/UCf36btbKZPx8wTvIP6jKPaQ # Importiamo la libreria string per gestire le righe dei file import string # In questa variabile inseriamo il percorso del file di log pathlog = '/var/log/' # Indichiamo in questa variabile il file di log su da verificare filelog = 'auth.log' # Specifichiamo il path file hosts.deny pathban = '/etc/' # fileban = 'hosts.deny' # Nella variabile target specifichiamo la stringa da utilizzare nella ricerca degli indirizzi IP # che stanno tentando l'accesso nel nostro sistema. Sappiamo che i log sono presenti nel # file /var/log/auth.log e la riga del log con l'accesso fallito e' # Failed password for invalid user admin from 192.168.1.2 port 17727 ssh2 # Quindi prendiamo come riferimento la stringa 'Failed password' # target = 'Failed password' # Numero di tentativi massimi consentiti da ogni IP per connettersi al server # su cui e' in esecuzione questo script. # BANNA = 3 # Iniziamo a realizzare il codice vero e proprio: # Contiamo il numero di caratteri della stringa contenuta in target, questo numero ci # permettera' di gestire la stringa e identificare in modo assolutamente preciso l'IP da bloccare. # lunghezza = len(target) # Apro il file auth.log in sola lettura (perche' devo semplicemente ricavare l'informazione # sulle connessioni e sugli IP) # f = file(pathlog+filelog, 'r') # Creiamo un dizionario python contenente gli IP bannati. # Il dizionario e' una struttura che ci permette di gestire le informazioni per chiave e valore # nel nostro caso useremo come chiave l'IP e come valore un numero intero che conta le volte # che l'IP non riesce ad eseguire l'accesso. # {key:valore, key2:valore2, …} # es.: {'192.168.1.2': 2, '172.16.8.10': 3} # ip_bannati = {} # Leggo la prima riga del file auth.log e copio il contenuto nella variabile i; i = f.readline() # Ciclo il file finche' la variabile i che contiene la riga da esaminare non e' vuota # quindi finche' il file auth.log non e' terminato. # while (i != \"\"): # Tramite il metodo find di string ottengo la posizione della stringa in cui stato trovato il target # posizione = string.find(i,target) # Se la posizione e' diversa da -1 significa che il targhet e' stato trovato # Quindi la stringa letta contiene 'Failed password' ora dobbiamo riuscire a prendere # la parte della stringa che contiene l'IP if posizione != -1: # RICERCA IP # Concentriamoci sulla riga del file auth.log e in particolare alle parole tra cui l'IP # e' compreso: from 192.168.1.2 port # # Prima di identificare l'IP faccio la ricerca della stringa # from per assicurarmi la corretta posizione # inizio = string.find(i,\"from\") if inizio != -1 : inizio = inizio + 5 # +5 caratteri di from e spazio # Calcolo la posizione finale tramite la stringa port fine = string.find(i,\"port\") # Ottengo la substring con con l'IP da bannare ip = i[inizio:fine-1] # Se l'IP e' gia' presente in ip_bannati if ip in ip_bannati: # Aggiorna semplicemente il suo contatore ip_bannati[ip] = ip_bannati[ip] + 1 else : # Altrimenti inserisci l'IP e imposta il suo contatore a 1 ip_bannati[ip] = 1 # A questo punto abbiamo finito il lavoro su una singola riga quindi procediamo # con la riga successiva del file auth.log e ed esaminiamola nuovamente con il ciclo while i = f.readline() # In questo punto siamo usciti dal while, questo significa che il file auth.log e' terminato # e non abbiamo altre righe da esaminare, quindi possiamo chiudere il file. f.close() # Creo una copia di backup del file hosts.deny perche' ogni volta che lancio lo script # perdo gli IP bloccati precedentemente denyold = file(pathban+fileban, 'r') # Apro hosts.deny in lettura deny = file('_'+fileban, 'w') # Creo il file _hosts.deny di backup # Leggo tutte le righe di hosts.deny e le copio in _hosts.deny i = denyold.readline() while (i!=\"\"): deny.write(i) i = denyold.readline() # Ora non resta che verificare quali IP hanno superato il numero # massimo di tentativi consentiti e scriverli nel file _hosts.deny con la regola opportuna. # # Ciclo per verificare tutti gli IP inseriti nel dizionario # for i in ip_bannati : # Se l'IP ha superato il numero massimo di tentativi # if ip_bannati[i] \u003e BANNA : # Scrivi nel file hosts.deny l'IP con la regola ALL = BLOCCA TUTTO # es.: ALL:192.168.1.10 e vai a capo. # deny.write('ALL:'+ i+'\\n') # Chiudo i file denyold.close() deny.close() # Copio il contenuto di _hosts.deny nel file /etc/hosts.deny deny = file(pathban+fileban, 'w') denytmp = file('_'+fileban, 'r') i = denytmp.readline() while (i!=\"\"): deny.write(i) i = denytmp.readline() denytmp.close() deny.close() # Fine ","wordCount":"1161","inLanguage":"en","datePublished":"2025-08-13T00:00:00Z","dateModified":"2025-08-13T00:00:00Z","author":{"@type":"Person","name":"Vincenzo Argese"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cr1s1um.github.io/en/post/bannator-python-script-blocks-brute-force/"},"publisher":{"@type":"Organization","name":"~# cr1s1um \u003e /dev/random","logo":{"@type":"ImageObject","url":"https://cr1s1um.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cr1s1um.github.io/en/ accesskey=h title="~# cr1s1um > /dev/random (Alt + H)">~# cr1s1um > /dev/random</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://cr1s1um.github.io/it/ title=Italiano aria-label=Italiano>It</a></li></ul></div></div><ul id=menu><li><a href=https://cr1s1um.github.io/en/ title=home><span>home</span></a></li><li><a href=https://cr1s1um.github.io/en/post title=blog><span>blog</span></a></li><li><a href=https://cr1s1um.github.io/en/about-me title="about me"><span>about me</span></a></li><li><a href=https://x.com/cr1s1um title=x><span>x</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://github.com/cr1s1um title=github><span>github</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://cr1s1um.github.io/en/search title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cr1s1um.github.io/en/>Home</a>&nbsp;»&nbsp;<a href=https://cr1s1um.github.io/en/post/>Posts</a></div><h1 class="post-title entry-hint-parent">/* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */</h1><div class=post-description>Discover bannator.py: a 44 line Python script that blocks brute force attacks on Linux. A practical example of security and coding.</div><div class=post-meta><span title='2025-08-13 00:00:00 +0000 UTC'>August 13, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Vincenzo Argese</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a></li><li><a href=#why-bring-it-back-today aria-label="Why bring it back today?">Why bring it back today?</a><ul><li><a href=#useful-links aria-label="Useful links">Useful links</a></li></ul></li><li><a href=#full-code aria-label="Full Code">Full Code</a></li></ul></div></details></div><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Some projects are born out of technical necessity, others from curiosity and the desire to experiment.<br><strong>Bannator.py</strong> was created for all these reasons.</p><p>It was <strong>April 2, 2010</strong>. I was working as a consultant for a company that was experiencing repeated unauthorized access attempts on its servers: classic <strong>SSH password brute force attacks</strong>. A quick, simple, and understandable solution was needed. I could have written a couple of lines in <strong>Bash</strong> and solved the problem in a few minutes… but this was also an opportunity: to turn a technical need into a learning moment.</p><p>The company’s technical team had shown interest in <strong>Python</strong>, considering it more “readable” and “user-friendly” compared to Bash scripts and other sysadmin-oriented solutions. So, I decided to create a small script of just <strong>44 lines</strong>, commented <strong>line by line</strong>, so it would not only be a tool but also a practical example of system automation in Python.</p><p>The result was <strong>Bannator.py</strong> – named because it’s the <em>terminator</em> of annoying IPs.</p><p>A script that:</p><ul><li><strong>Reads</strong> the authentication logs (<code>/var/log/auth.log</code>)</li><li><strong>Identifies IPs</strong> with multiple failed login attempts</li><li><strong>Counts</strong> failed attempts</li><li><strong>Automatically blocks</strong> persistent IPs by writing them into <code>/etc/hosts.deny</code></li><li><strong>Creates a backup</strong> of the block file, so no rules are lost</li></ul><p>I also created a <strong>YouTube video tutorial</strong> showing the script in action on a VirtualBox machine running Debian (version 5.0 Lenny). It was a way to combine teaching and real-world practice, demonstrating how a security issue can be solved with a simple “homegrown” but effective approach.</p><h2 id=why-bring-it-back-today>Why bring it back today?<a hidden class=anchor aria-hidden=true href=#why-bring-it-back-today>#</a></h2><p>Today is August 14, 2025. More than 15 years after its first publication, Bannator.py is obviously outdated (…it already was) compared to modern integrated security solutions, but it still remains:</p><ul><li>A perfect example for anyone who wants to learn how to read and write Python scripts</li><li>A practical exercise in log parsing</li><li>A small piece of personal history</li></ul><h3 id=useful-links>Useful links<a hidden class=anchor aria-hidden=true href=#useful-links>#</a></h3><ul><li><a href=https://github.com/cr1s1um/OpenCodeLab/blob/main/python/bannator.py>GitHub Project</a></li><li><a href="https://www.youtube.com/watch?v=Kq5_5ZRqnZE">YouTube Video Tutorial</a></li></ul><hr><h2 id=full-code>Full Code<a hidden class=anchor aria-hidden=true href=#full-code>#</a></h2><ul><li>Original code dated April 2, 2010</li><li>Republished on an old website on February 23, 2023</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python</span>
</span></span><span class=line><span class=cl><span class=c1># -*- coding: utf-8 -*-</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Autore: Vincenzo Argese @crisiumdevstudio</span>
</span></span><span class=line><span class=cl><span class=c1># YouTube: https://www.youtube.com/@crisiumdevstudio &lt;-- Iscriviti e attiva la campanella GRAZIE</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Script: bannator.py</span>
</span></span><span class=line><span class=cl><span class=c1># Descrizione: Script Python – bloccare IP da attacchi brute force</span>
</span></span><span class=line><span class=cl><span class=c1># Data pubblicazione: 2 Aprile 2010 (Data di oggi 23 feb 2023 ...OMG)</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Web: www.vasystems.it</span>
</span></span><span class=line><span class=cl><span class=c1># Articolo: https://www.informaticawebsystems.com/guida-script-python-bloccare-indirizzi-ip-attacchi-brute-force/</span>
</span></span><span class=line><span class=cl><span class=c1># (Ex-Progetto) Progetto Elven.it WebTV: https://www.youtube.com/channel/UCf36btbKZPx8wTvIP6jKPaQ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Importiamo la libreria string per gestire le righe dei file</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In questa variabile inseriamo il percorso del file di log</span>
</span></span><span class=line><span class=cl><span class=n>pathlog</span> <span class=o>=</span> <span class=s1>&#39;/var/log/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Indichiamo in questa variabile il file di log su da verificare</span>
</span></span><span class=line><span class=cl><span class=n>filelog</span> <span class=o>=</span> <span class=s1>&#39;auth.log&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Specifichiamo il path file hosts.deny</span>
</span></span><span class=line><span class=cl><span class=n>pathban</span> <span class=o>=</span> <span class=s1>&#39;/etc/&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>fileban</span> <span class=o>=</span> <span class=s1>&#39;hosts.deny&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nella variabile target specifichiamo la stringa da utilizzare nella ricerca degli indirizzi IP</span>
</span></span><span class=line><span class=cl><span class=c1># che stanno tentando l&#39;accesso nel nostro sistema. Sappiamo che i log sono presenti nel</span>
</span></span><span class=line><span class=cl><span class=c1># file /var/log/auth.log e la riga del log con l&#39;accesso fallito e&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># Failed password for invalid user admin from 192.168.1.2 port 17727 ssh2</span>
</span></span><span class=line><span class=cl><span class=c1># Quindi prendiamo come riferimento la stringa &#39;Failed password&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;Failed password&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Numero di tentativi massimi consentiti da ogni IP per connettersi al server</span>
</span></span><span class=line><span class=cl><span class=c1># su cui e&#39; in esecuzione questo script.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>BANNA</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Iniziamo a realizzare il codice vero e proprio:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Contiamo il numero di caratteri della stringa contenuta in target, questo numero ci</span>
</span></span><span class=line><span class=cl><span class=c1># permettera&#39; di gestire la stringa e identificare in modo assolutamente preciso l&#39;IP da bloccare.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>lunghezza</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Apro il file auth.log in sola lettura (perche&#39; devo semplicemente ricavare l&#39;informazione</span>
</span></span><span class=line><span class=cl><span class=c1># sulle connessioni e sugli IP)</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=n>file</span><span class=p>(</span><span class=n>pathlog</span><span class=o>+</span><span class=n>filelog</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Creiamo un dizionario python contenente gli IP bannati.</span>
</span></span><span class=line><span class=cl><span class=c1># Il dizionario e&#39; una struttura che ci permette di gestire le informazioni per chiave e valore</span>
</span></span><span class=line><span class=cl><span class=c1># nel nostro caso useremo come chiave l&#39;IP e come valore un numero intero che conta le volte</span>
</span></span><span class=line><span class=cl><span class=c1># che l&#39;IP non riesce ad eseguire l&#39;accesso.</span>
</span></span><span class=line><span class=cl><span class=c1># {key:valore, key2:valore2, …}</span>
</span></span><span class=line><span class=cl><span class=c1># es.: {&#39;192.168.1.2&#39;: 2, &#39;172.16.8.10&#39;: 3}</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>ip_bannati</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Leggo la prima riga del file auth.log e copio il contenuto nella variabile i;</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ciclo il file finche&#39; la variabile i che contiene la riga da esaminare non e&#39; vuota</span>
</span></span><span class=line><span class=cl><span class=c1># quindi finche&#39; il file auth.log non e&#39; terminato.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=n>i</span> <span class=o>!=</span> <span class=s2>&#34;&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Tramite il metodo find di string ottengo la posizione della stringa in cui stato trovato il target</span>
</span></span><span class=line><span class=cl>    <span class=c1>#</span>
</span></span><span class=line><span class=cl>    <span class=n>posizione</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Se la posizione e&#39; diversa da -1 significa che il targhet e&#39; stato trovato</span>
</span></span><span class=line><span class=cl>    <span class=c1># Quindi la stringa letta contiene &#39;Failed password&#39; ora dobbiamo riuscire a prendere</span>
</span></span><span class=line><span class=cl>    <span class=c1># la parte della stringa che contiene l&#39;IP</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>posizione</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># RICERCA IP</span>
</span></span><span class=line><span class=cl>        <span class=c1># Concentriamoci sulla riga del file auth.log e in particolare alle parole tra cui l&#39;IP</span>
</span></span><span class=line><span class=cl>        <span class=c1># e&#39; compreso: from 192.168.1.2 port</span>
</span></span><span class=line><span class=cl>        <span class=c1>#</span>
</span></span><span class=line><span class=cl>        <span class=c1># Prima di identificare l&#39;IP faccio la ricerca della stringa</span>
</span></span><span class=line><span class=cl>        <span class=c1># from per assicurarmi la corretta posizione</span>
</span></span><span class=line><span class=cl>        <span class=c1>#</span>
</span></span><span class=line><span class=cl>        <span class=n>inizio</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=s2>&#34;from&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>inizio</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>inizio</span> <span class=o>=</span> <span class=n>inizio</span> <span class=o>+</span> <span class=mi>5</span> <span class=c1># +5 caratteri di from e spazio</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Calcolo la posizione finale tramite la stringa port</span>
</span></span><span class=line><span class=cl>            <span class=n>fine</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=s2>&#34;port&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Ottengo la substring con con l&#39;IP da bannare</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>=</span> <span class=n>i</span><span class=p>[</span><span class=n>inizio</span><span class=p>:</span><span class=n>fine</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Se l&#39;IP e&#39; gia&#39; presente in ip_bannati</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>ip</span> <span class=ow>in</span> <span class=n>ip_bannati</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Aggiorna semplicemente il suo contatore</span>
</span></span><span class=line><span class=cl>                <span class=n>ip_bannati</span><span class=p>[</span><span class=n>ip</span><span class=p>]</span> <span class=o>=</span> <span class=n>ip_bannati</span><span class=p>[</span><span class=n>ip</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Altrimenti inserisci l&#39;IP e imposta il suo contatore a 1</span>
</span></span><span class=line><span class=cl>                <span class=n>ip_bannati</span><span class=p>[</span><span class=n>ip</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># A questo punto abbiamo finito il lavoro su una singola riga quindi procediamo</span>
</span></span><span class=line><span class=cl>        <span class=c1># con la riga successiva del file auth.log e ed esaminiamola nuovamente con il ciclo while</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In questo punto siamo usciti dal while, questo significa che il file auth.log e&#39; terminato</span>
</span></span><span class=line><span class=cl><span class=c1># e non abbiamo altre righe da esaminare, quindi possiamo chiudere il file.</span>
</span></span><span class=line><span class=cl><span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Creo una copia di backup del file hosts.deny perche&#39; ogni volta che lancio lo script</span>
</span></span><span class=line><span class=cl><span class=c1># perdo gli IP bloccati precedentemente</span>
</span></span><span class=line><span class=cl><span class=n>denyold</span> <span class=o>=</span> <span class=n>file</span><span class=p>(</span><span class=n>pathban</span><span class=o>+</span><span class=n>fileban</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=c1># Apro hosts.deny in lettura</span>
</span></span><span class=line><span class=cl><span class=n>deny</span> <span class=o>=</span> <span class=n>file</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=o>+</span><span class=n>fileban</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=c1># Creo il file _hosts.deny di backup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Leggo tutte le righe di hosts.deny e le copio in _hosts.deny</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=n>denyold</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=n>i</span><span class=o>!=</span><span class=s2>&#34;&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>deny</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>denyold</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ora non resta che verificare quali IP hanno superato il numero</span>
</span></span><span class=line><span class=cl><span class=c1># massimo di tentativi consentiti e scriverli nel file _hosts.deny con la regola opportuna.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Ciclo per verificare tutti gli IP inseriti nel dizionario</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>ip_bannati</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Se l&#39;IP ha superato il numero massimo di tentativi</span>
</span></span><span class=line><span class=cl>    <span class=c1>#</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>ip_bannati</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>BANNA</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Scrivi nel file hosts.deny l&#39;IP con la regola ALL = BLOCCA TUTTO</span>
</span></span><span class=line><span class=cl>        <span class=c1># es.: ALL:192.168.1.10 e vai a capo.</span>
</span></span><span class=line><span class=cl>        <span class=c1>#</span>
</span></span><span class=line><span class=cl>        <span class=n>deny</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;ALL:&#39;</span><span class=o>+</span> <span class=n>i</span><span class=o>+</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chiudo i file</span>
</span></span><span class=line><span class=cl><span class=n>denyold</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>deny</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Copio il contenuto di _hosts.deny nel file /etc/hosts.deny</span>
</span></span><span class=line><span class=cl><span class=n>deny</span> <span class=o>=</span> <span class=n>file</span><span class=p>(</span><span class=n>pathban</span><span class=o>+</span><span class=n>fileban</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>denytmp</span> <span class=o>=</span> <span class=n>file</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=o>+</span><span class=n>fileban</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=n>denytmp</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=n>i</span><span class=o>!=</span><span class=s2>&#34;&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>deny</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>denytmp</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>denytmp</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>deny</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># Fine</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://cr1s1um.github.io/en/tags/programming-languages/>Programming Languages</a></li><li><a href=https://cr1s1um.github.io/en/tags/python/>Python</a></li></ul><nav class=paginav><a class=next href=https://cr1s1um.github.io/en/post/perceptron-c-artificial-neuron-first-step/><span class=title>Next »</span><br><span>/* Build Your First Artificial Neuron in C: The Perceptron Made Simple */</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share /* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ on x" href="https://x.com/intent/tweet/?text=%2f%2a%20bannator.py%3a%20The%2044%20line%20Python%20Script%20That%20Blocks%20Brute%20Force%20Attacks%20%28this%20script%20introduces%20you%20to%20programming%21%29%20%2a%2f&amp;url=https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f&amp;hashtags=Programminglanguages%2cPython"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share /* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f&amp;title=%2f%2a%20bannator.py%3a%20The%2044%20line%20Python%20Script%20That%20Blocks%20Brute%20Force%20Attacks%20%28this%20script%20introduces%20you%20to%20programming%21%29%20%2a%2f&amp;summary=%2f%2a%20bannator.py%3a%20The%2044%20line%20Python%20Script%20That%20Blocks%20Brute%20Force%20Attacks%20%28this%20script%20introduces%20you%20to%20programming%21%29%20%2a%2f&amp;source=https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share /* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f&title=%2f%2a%20bannator.py%3a%20The%2044%20line%20Python%20Script%20That%20Blocks%20Brute%20Force%20Attacks%20%28this%20script%20introduces%20you%20to%20programming%21%29%20%2a%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share /* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share /* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ on whatsapp" href="https://api.whatsapp.com/send?text=%2f%2a%20bannator.py%3a%20The%2044%20line%20Python%20Script%20That%20Blocks%20Brute%20Force%20Attacks%20%28this%20script%20introduces%20you%20to%20programming%21%29%20%2a%2f%20-%20https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share /* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ on telegram" href="https://telegram.me/share/url?text=%2f%2a%20bannator.py%3a%20The%2044%20line%20Python%20Script%20That%20Blocks%20Brute%20Force%20Attacks%20%28this%20script%20introduces%20you%20to%20programming%21%29%20%2a%2f&amp;url=https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share /* bannator.py: The 44 line Python Script That Blocks Brute Force Attacks (this script introduces you to programming!) */ on ycombinator" href="https://news.ycombinator.com/submitlink?t=%2f%2a%20bannator.py%3a%20The%2044%20line%20Python%20Script%20That%20Blocks%20Brute%20Force%20Attacks%20%28this%20script%20introduces%20you%20to%20programming%21%29%20%2a%2f&u=https%3a%2f%2fcr1s1um.github.io%2fen%2fpost%2fbannator-python-script-blocks-brute-force%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://utteranc.es/client.js repo=cr1s1um/cr1s1um.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></article></main><footer class=footer><div class=footer-menu><span><a href=/>home</a></span>
<span><a href=/en/archives/>archives</a></span>
<span><a href=/en/privacy/>privacy and cookie policy</a></span></div><span>&copy; 2025 <a href=https://cr1s1um.github.io/en/>~# cr1s1um > /dev/random</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><style>#consent-notice{padding:1rem;display:none;text-align:center;position:fixed;bottom:0;width:calc(100% - 2rem);background:#222;color:#fff}#consent-notice span{margin-right:1rem}#consent-notice button{cursor:pointer;display:inline-block;width:auto}#consent-notice span a{color:inherit;text-decoration:underline;text-decoration-color:#fff}#consent-notice button.btn{margin-left:.5rem;color:#fff}#consent-notice button.btn.manage-consent{background:#5c5c5c;font-weight:400}#consent-overlay{position:fixed;left:0;top:0;width:100%;height:100vh;display:none;background:rgba(0,0,0,.75);z-index:999999;overflow:auto;cursor:pointer}#consent-overlay.active{display:flex}#consent-overlay>div{background:#000;width:100%;max-width:30rem;padding:1.75rem;margin:auto;cursor:initial}#consent-overlay>div>div{display:flex;align-items:flex-start;margin-bottom:1rem}#consent-overlay>div>div:last-child{margin:0}#consent-overlay h3{padding-top:0}#consent-overlay input{margin-top:.3rem}#consent-overlay label{display:block}#consent-overlay .btn{margin-right:.5rem;color:#fff}#consent-overlay button.btn.save-consent{background:#5c5c5c;font-weight:400}#consent-overlay{color:#fff}#consent-overlay h3{color:#fff}@media(max-width:767px){#consent-overlay>div{padding:1.75rem 1rem}#consent-notice span{display:block;padding-top:3px;margin-bottom:1.5rem}#consent-notice button.btn{position:relative;bottom:4px}}</style><div id=consent-notice><span>Questo sito utilizza i cookie per migliorare l'esperienza di utilizzo, leggi la sezione <a class=manage-consent href=/privacy>Privacy e Cookie</a> per maggiori informazioni.</span><button class="btn manage-consent"> /* Gestisci le preferenze */ </gestisci></button><button class="btn deny-consent"> /* Rifiuta */ </button><button class="btn approve-consent"> /* Accetta */</button></div><div id=consent-overlay><div><div><input type=checkbox id=item0 value=1 name=item0>
<label for=item0><h3>Google Anaytics</h3><p>Il sito utilizza Google Analytics (gtag.js) per analizzare in forma aggregata le visite al sito e migliorare i contenuti. I cookie possono raccogliere informazioni come l’indirizzo IP, browser, dispositivo, sistema operativo, pagine visitate. La base giuridica è il consenso dell’interessato (art. 6, par. 1, lett. a GDPR). Il tracciamento è attivo solo previo consenso tramite banner cookie.</p></label></div><div><button id=save-consent class="btn save-consent" data-consentvalue=0> /* Salva le preferenze */ </button><button class="btn approve-consent"> /* Accetta tutto */</button></div></div></div><script>const scripts=[];scripts[0]="/js/gtag.js";function createCookie(e,t,n){var s,o="";n&&(s=new Date,s.setTime(s.getTime()+n*24*60*60*1e3),o="; expires="+s.toUTCString()),document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t,s=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(t=o[n];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(s)==0)return t.substring(s.length,t.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}function denyAllConsentScripts(){var e="";scripts.forEach(function(){e=e+"0"}),acceptSomeConsentScripts(e)}function acceptAllConsentScripts(){var e="";scripts.forEach(function(){e=e+"1"}),acceptSomeConsentScripts(e)}function acceptSomeConsentScripts(e){setConsentInputs(e),createCookie("consent-settings",e,31),document.getElementById("consent-notice").style.display="none",document.getElementById("consent-overlay").classList.remove("active"),loadConsentScripts(e)}function loadConsentScripts(e){scripts.forEach(function(t,n){if(e[n]=="1"){var s=document.createElement("script");s.type="text/javascript",s.src=t,document.body.appendChild(s)}})}function setConsentInputs(e){var t=document.querySelectorAll("#consent-overlay input:not([disabled])");t.forEach(function(t,n){e[n]=="1"?t.checked=!0:t.checked=!1})}function setConsentValue(){var t=document.querySelectorAll("#consent-overlay input:not([disabled])"),e="";t.forEach(function(t){t.checked?e=e+"1":e=e+"0"}),document.getElementById("save-consent").dataset.consentvalue=e}var consentValue,elements=document.querySelectorAll("#consent-overlay input:not([disabled])");elements.forEach(function(e){e.checked=!1}),readCookie("consent-settings")?(consentValue=readCookie("consent-settings").toString(),setConsentInputs(consentValue),loadConsentScripts(consentValue)):document.getElementById("consent-notice").style.display="block",elements=document.querySelectorAll(".manage-consent"),elements.forEach(function(e){e.addEventListener("click",function(){document.getElementById("consent-overlay").classList.toggle("active")})}),elements=document.querySelectorAll(".deny-consent"),elements.forEach(function(e){e.addEventListener("click",function(){denyAllConsentScripts()})}),elements=document.querySelectorAll(".approve-consent"),elements.forEach(function(e){e.addEventListener("click",function(){acceptAllConsentScripts()})}),document.getElementById("save-consent").addEventListener("click",function(){setConsentValue(),acceptSomeConsentScripts(this.dataset.consentvalue)}),document.getElementById("consent-overlay").addEventListener("click",function(e){document.querySelector("#consent-overlay > div").contains(e.target)||this.classList.toggle("active")})</script></body></html>